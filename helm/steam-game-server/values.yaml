# Default values for steam-game-server
# This is a YAML-formatted file.
# Declare variables to be passed into your templates.

replicaCount: 1

image:
  repository: steamcmd/steamcmd
  pullPolicy: IfNotPresent
  tag: latest

imagePullSecrets: []
nameOverride: ""
fullnameOverride: ""

serviceAccount:
  create: true
  annotations: {}
  name: ""

podAnnotations: {}

podSecurityContext:
  runAsNonRoot: false
  fsGroup: 1000

securityContext:
  allowPrivilegeEscalation: false
  capabilities:
    drop:
      - ALL
  readOnlyRootFilesystem: false
  runAsNonRoot: false
  runAsUser: 0

service:
  type: LoadBalancer
  # Port to expose on the service (typically the game port)
  port: 7777
  # Container port for the game server (UDP)
  targetPort: 7777
  annotations: {}
  # nodePort: 30000  # Uncomment to specify a nodePort

# Game server installation and environment
gameServer:
  # SteamID of the game to install (e.g., 232250 for ARK, 258550 for Valheim, 1391110 for RUST)
  steamId: "232250"
  # Command to start the game server (executed after installation)
  # Example for ARK: "cd /home/steam/serverfiles && ./ShooterGame/Binaries/Linux/ShooterGameServer"
  startCommand: ""
  # Additional environment variables to pass to the server process
  env: []
    # - name: ENV_VAR_NAME
    #   value: "ENV_VAR_VALUE"

# Server configuration files (supports multiple files mounted at different paths)
# Define one or more config files to mount into the pod
serverConfigs:
  default:
    # The filename within the ConfigMap
    filename: "server.cfg"
    # The mount path inside the pod where this file will be available
    mountPath: "/home/steam/server"
    # Raw config file content
    content: |
      [ServerConfig]
      # Configure your game server here
  # Add more configs as needed, e.g.:
  # gameSettings:
  #   filename: "GameUserSettings.ini"
  #   mountPath: "/home/steam/gamefiles"
  #   content: |
  #     [Settings]
  #     ...
  # startup:
  #   filename: "startup.sh"
  #   mountPath: "/home/steam/scripts"
  #   content: |
  #     #!/bin/bash
  #     ...
  #   content: |
  #     [Settings]
  #     ..."
  # advanced:
  #   filename: "advanced.cfg"
  #   mountPath: "/home/steam/config"
  #   content: |
  #     ...

# Persistence configuration
persistence:
  # Enable persistent volume
  enabled: true
  # Storage class to use
  storageClass: "standard"
  # Access mode for the volume
  accessMode: ReadWriteOnce
  # Size of the persistent volume
  size: 50Gi
  # Annotations for the PVC
  annotations: {}
  # Selector to match existing PV
  selector: {}
    # matchLabels:
    #   app: steam-server
  # Existing PVC to use
  existingClaim: ""
  # Mount path for the persistent volume
  mountPath: /home/steam/serverfiles

# Ingress configuration
ingress:
  enabled: true
  className: "nginx"
  annotations:
    cert-manager.io/cluster-issuer: "letsencrypt-prod"
    # nginx.ingress.kubernetes.io/rewrite-target: /
  hosts:
    - host: gameserver.example.com
      paths:
        - path: /
          pathType: Prefix
  tls:
    - secretName: gameserver-tls
      hosts:
        - gameserver.example.com

# Resource limits and requests
resources:
  limits:
    cpu: 4
    memory: 8Gi
  requests:
    cpu: 2
    memory: 4Gi

# Autoscaling
autoscaling:
  enabled: false
  minReplicas: 1
  maxReplicas: 3
  targetCPUUtilizationPercentage: 80
  targetMemoryUtilizationPercentage: 80

# Node selector
nodeSelector: {}

# Tolerations
tolerations: []

# Affinity rules
affinity: {}


